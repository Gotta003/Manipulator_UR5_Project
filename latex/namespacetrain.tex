\doxysection{train Namespace Reference}
\hypertarget{namespacetrain}{}\label{namespacetrain}\index{train@{train}}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespacetrain_aff3e936230788ec1ff45538929277533}{train}} (\mbox{\hyperlink{namespacetrain_a8ce47f3ce85e34ed945573b80e08aaf6}{opt}}, device)
\item 
\mbox{\hyperlink{namespacetrain_a3c7f10b4f480ab5baa3739aafc54a490}{parse\+\_\+opt}} (known=False)
\item 
\mbox{\hyperlink{namespacetrain_aa55a3dab9fbcc2dcafe0fddce9cb144a}{main}} (\mbox{\hyperlink{namespacetrain_a8ce47f3ce85e34ed945573b80e08aaf6}{opt}})
\item 
\mbox{\hyperlink{namespacetrain_aae3f0d680cfbdc937d9bab64a150bd72}{run}} (\texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}kwargs)
\item 
\mbox{\hyperlink{namespacetrain_a165c8db7d0d098f2da9f04f83eb4a443}{train}} (hyp, \mbox{\hyperlink{namespacetrain_a8ce47f3ce85e34ed945573b80e08aaf6}{opt}}, device, callbacks)
\item 
\mbox{\hyperlink{namespacetrain_acd078656d0187c4782aa687a0c407edd}{main}} (\mbox{\hyperlink{namespacetrain_a8ce47f3ce85e34ed945573b80e08aaf6}{opt}}, callbacks=\mbox{\hyperlink{classutils_1_1callbacks_1_1_callbacks}{Callbacks}}())
\item 
\mbox{\hyperlink{namespacetrain_a3b5b2b18a1e55050ca56f90e6e322370}{generate\+\_\+individual}} (input\+\_\+ranges, individual\+\_\+length)
\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespacetrain_add74d372d0a1ebe4092c91d501f92034}{FILE}} = Path(\+\_\+\+\_\+file\+\_\+\+\_\+).resolve()
\item 
\mbox{\hyperlink{namespacetrain_aa1aebe5c6044ab0d9f4eb2f387439700}{ROOT}} = FILE.\+parents\mbox{[}1\mbox{]}
\item 
\mbox{\hyperlink{namespacetrain_abc52041aeca5611a7d219e612c36a7b2}{LOCAL\+\_\+\+RANK}} = int(os.\+getenv("{}LOCAL\+\_\+\+RANK"{}, -\/1))
\item 
\mbox{\hyperlink{namespacetrain_a6dd13c1a6cf9587741f3de1e8339b7c1}{RANK}} = int(os.\+getenv("{}RANK"{}, -\/1))
\item 
\mbox{\hyperlink{namespacetrain_aae43f9902f6ea4d5d5603f84d2e8212c}{WORLD\+\_\+\+SIZE}} = int(os.\+getenv("{}WORLD\+\_\+\+SIZE"{}, 1))
\item 
\mbox{\hyperlink{namespacetrain_ae603c070a3f7f6ce8fea4b0e4148135b}{GIT\+\_\+\+INFO}} = check\+\_\+git\+\_\+info()
\item 
\mbox{\hyperlink{namespacetrain_a8ce47f3ce85e34ed945573b80e08aaf6}{opt}} = \mbox{\hyperlink{namespacetrain_a3c7f10b4f480ab5baa3739aafc54a490}{parse\+\_\+opt}}()
\item 
\mbox{\hyperlink{namespacetrain_a64cf27375407e6f7fedc86c8a87dc636}{comet\+\_\+ml}} = None
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\begin{DoxyVerb}Train a YOLOv5 classifier model on a classification dataset.

Usage - Single-GPU training:
    $ python classify/train.py --model yolov5s-cls.pt --data imagenette160 --epochs 5 --img 224

Usage - Multi-GPU DDP training:
    $ python -m torch.distributed.run --nproc_per_node 4 --master_port 2022 classify/train.py --model yolov5s-cls.pt --data imagenet --epochs 5 --img 224 --device 0,1,2,3

Datasets:           --data mnist, fashion-mnist, cifar10, cifar100, imagenette, imagewoof, imagenet, or 'path/to/data'
YOLOv5-cls models:  --model yolov5n-cls.pt, yolov5s-cls.pt, yolov5m-cls.pt, yolov5l-cls.pt, yolov5x-cls.pt
Torchvision models: --model resnet50, efficientnet_b0, etc. See https://pytorch.org/vision/stable/models.html
\end{DoxyVerb}


\begin{DoxyVerb}Train a YOLOv5 segment model on a segment dataset Models and datasets download automatically from the latest YOLOv5
release.

Usage - Single-GPU training:
    $ python segment/train.py --data coco128-seg.yaml --weights yolov5s-seg.pt --img 640  # from pretrained (recommended)
    $ python segment/train.py --data coco128-seg.yaml --weights '' --cfg yolov5s-seg.yaml --img 640  # from scratch

Usage - Multi-GPU DDP training:
    $ python -m torch.distributed.run --nproc_per_node 4 --master_port 1 segment/train.py --data coco128-seg.yaml --weights yolov5s-seg.pt --img 640 --device 0,1,2,3

Models:     https://github.com/ultralytics/yolov5/tree/master/models
Datasets:   https://github.com/ultralytics/yolov5/tree/master/data
Tutorial:   https://docs.ultralytics.com/yolov5/tutorials/train_custom_data
\end{DoxyVerb}


\begin{DoxyVerb}Train a YOLOv5 model on a custom dataset. Models and datasets download automatically from the latest YOLOv5 release.

Usage - Single-GPU training:
    $ python train.py --data coco128.yaml --weights yolov5s.pt --img 640  # from pretrained (recommended)
    $ python train.py --data coco128.yaml --weights '' --cfg yolov5s.yaml --img 640  # from scratch

Usage - Multi-GPU DDP training:
    $ python -m torch.distributed.run --nproc_per_node 4 --master_port 1 train.py --data coco128.yaml --weights yolov5s.pt --img 640 --device 0,1,2,3

Models:     https://github.com/ultralytics/yolov5/tree/master/models
Datasets:   https://github.com/ultralytics/yolov5/tree/master/data
Tutorial:   https://docs.ultralytics.com/yolov5/tutorials/train_custom_data
\end{DoxyVerb}
 

\doxysubsection{Function Documentation}
\Hypertarget{namespacetrain_a3b5b2b18a1e55050ca56f90e6e322370}\index{train@{train}!generate\_individual@{generate\_individual}}
\index{generate\_individual@{generate\_individual}!train@{train}}
\doxysubsubsection{\texorpdfstring{generate\_individual()}{generate\_individual()}}
{\footnotesize\ttfamily \label{namespacetrain_a3b5b2b18a1e55050ca56f90e6e322370} 
train.\+generate\+\_\+individual (\begin{DoxyParamCaption}\item[{}]{input\+\_\+ranges}{, }\item[{}]{individual\+\_\+length}{}\end{DoxyParamCaption})}

\begin{DoxyVerb}Generate an individual with random hyperparameters within specified ranges.

Args:
    input_ranges (list[tuple[float, float]]): List of tuples where each tuple contains the lower and upper bounds
        for the corresponding gene (hyperparameter).
    individual_length (int): The number of genes (hyperparameters) in the individual.

Returns:
    list[float]: A list representing a generated individual with random gene values within the specified ranges.

Example:
    ```python
    input_ranges = [(0.01, 0.1), (0.1, 1.0), (0.9, 2.0)]
    individual_length = 3
    individual = generate_individual(input_ranges, individual_length)
    print(individual)  # Output: [0.035, 0.678, 1.456] (example output)
    ```

Note:
    The individual returned will have a length equal to `individual_length`, with each gene value being a floating-point
    number within its specified range in `input_ranges`.
\end{DoxyVerb}
 \Hypertarget{namespacetrain_aa55a3dab9fbcc2dcafe0fddce9cb144a}\index{train@{train}!main@{main}}
\index{main@{main}!train@{train}}
\doxysubsubsection{\texorpdfstring{main()}{main()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily \label{namespacetrain_aa55a3dab9fbcc2dcafe0fddce9cb144a} 
train.\+main (\begin{DoxyParamCaption}\item[{}]{opt}{}\end{DoxyParamCaption})}

\begin{DoxyVerb}Executes YOLOv5 training with given options, handling device setup and DDP mode; includes pre-training checks.\end{DoxyVerb}
 \Hypertarget{namespacetrain_acd078656d0187c4782aa687a0c407edd}\index{train@{train}!main@{main}}
\index{main@{main}!train@{train}}
\doxysubsubsection{\texorpdfstring{main()}{main()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily \label{namespacetrain_acd078656d0187c4782aa687a0c407edd} 
train.\+main (\begin{DoxyParamCaption}\item[{}]{opt}{, }\item[{}]{callbacks}{ = {\ttfamily \mbox{\hyperlink{classutils_1_1callbacks_1_1_callbacks}{Callbacks}}()}}\end{DoxyParamCaption})}

\begin{DoxyVerb}Initializes training or evolution of YOLOv5 models based on provided configuration and options.\end{DoxyVerb}


\begin{DoxyVerb}Runs the main entry point for training or hyperparameter evolution with specified options and optional callbacks.

Args:
    opt (argparse.Namespace): The command-line arguments parsed for YOLOv5 training and evolution.
    callbacks (ultralytics.utils.callbacks.Callbacks, optional): Callback functions for various training stages.
        Defaults to Callbacks().

Returns:
    None

Note:
    For detailed usage, refer to:
    https://github.com/ultralytics/yolov5/tree/master/models
\end{DoxyVerb}
 \Hypertarget{namespacetrain_a3c7f10b4f480ab5baa3739aafc54a490}\index{train@{train}!parse\_opt@{parse\_opt}}
\index{parse\_opt@{parse\_opt}!train@{train}}
\doxysubsubsection{\texorpdfstring{parse\_opt()}{parse\_opt()}}
{\footnotesize\ttfamily \label{namespacetrain_a3c7f10b4f480ab5baa3739aafc54a490} 
train.\+parse\+\_\+opt (\begin{DoxyParamCaption}\item[{}]{known}{ = {\ttfamily False}}\end{DoxyParamCaption})}

\begin{DoxyVerb}Parses command line arguments for YOLOv5 training including model path, dataset, epochs, and more, returning
parsed arguments.
\end{DoxyVerb}


\begin{DoxyVerb}Parses command line arguments for training configurations, returning parsed arguments.

Supports both known and unknown args.
\end{DoxyVerb}


\begin{DoxyVerb}Parse command-line arguments for YOLOv5 training, validation, and testing.

Args:
    known (bool, optional): If True, parses known arguments, ignoring the unknown. Defaults to False.

Returns:
    (argparse.Namespace): Parsed command-line arguments containing options for YOLOv5 execution.

Example:
    ```python
    from ultralytics.yolo import parse_opt
    opt = parse_opt()
    print(opt)
    ```

Links:
    - Models: https://github.com/ultralytics/yolov5/tree/master/models
    - Datasets: https://github.com/ultralytics/yolov5/tree/master/data
    - Tutorial: https://docs.ultralytics.com/yolov5/tutorials/train_custom_data
\end{DoxyVerb}
 \Hypertarget{namespacetrain_aae3f0d680cfbdc937d9bab64a150bd72}\index{train@{train}!run@{run}}
\index{run@{run}!train@{train}}
\doxysubsubsection{\texorpdfstring{run()}{run()}}
{\footnotesize\ttfamily \label{namespacetrain_aae3f0d680cfbdc937d9bab64a150bd72} 
train.\+run (\begin{DoxyParamCaption}\item[{\texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}}]{kwargs}{}\end{DoxyParamCaption})}

\begin{DoxyVerb}Executes YOLOv5 model training or inference with specified parameters, returning updated options.

Example: from yolov5 import classify; classify.train.run(data=mnist, imgsz=320, model='yolov5m')
\end{DoxyVerb}


\begin{DoxyVerb}Executes YOLOv5 training with given parameters, altering options programmatically; returns updated options.

Example: import train; train.run(data='coco128.yaml', imgsz=320, weights='yolov5m.pt')
\end{DoxyVerb}


\begin{DoxyVerb}Execute YOLOv5 training with specified options, allowing optional overrides through keyword arguments.

Args:
    weights (str, optional): Path to initial weights. Defaults to ROOT / 'yolov5s.pt'.
    cfg (str, optional): Path to model YAML configuration. Defaults to an empty string.
    data (str, optional): Path to dataset YAML configuration. Defaults to ROOT / 'data/coco128.yaml'.
    hyp (str, optional): Path to hyperparameters YAML configuration. Defaults to ROOT / 'data/hyps/hyp.scratch-low.yaml'.
    epochs (int, optional): Total number of training epochs. Defaults to 100.
    batch_size (int, optional): Total batch size for all GPUs. Use -1 for automatic batch size determination. Defaults to 16.
    imgsz (int, optional): Image size (pixels) for training and validation. Defaults to 640.
    rect (bool, optional): Use rectangular training. Defaults to False.
    resume (bool | str, optional): Resume most recent training with an optional path. Defaults to False.
    nosave (bool, optional): Only save the final checkpoint. Defaults to False.
    noval (bool, optional): Only validate at the final epoch. Defaults to False.
    noautoanchor (bool, optional): Disable AutoAnchor. Defaults to False.
    noplots (bool, optional): Do not save plot files. Defaults to False.
    evolve (int, optional): Evolve hyperparameters for a specified number of generations. Use 300 if provided without a
        value.
    evolve_population (str, optional): Directory for loading population during evolution. Defaults to ROOT / 'data/ hyps'.
    resume_evolve (str, optional): Resume hyperparameter evolution from the last generation. Defaults to None.
    bucket (str, optional): gsutil bucket for saving checkpoints. Defaults to an empty string.
    cache (str, optional): Cache image data in 'ram' or 'disk'. Defaults to None.
    image_weights (bool, optional): Use weighted image selection for training. Defaults to False.
    device (str, optional): CUDA device identifier, e.g., '0', '0,1,2,3', or 'cpu'. Defaults to an empty string.
    multi_scale (bool, optional): Use multi-scale training, varying image size by ±50%. Defaults to False.
    single_cls (bool, optional): Train with multi-class data as single-class. Defaults to False.
    optimizer (str, optional): Optimizer type, choices are ['SGD', 'Adam', 'AdamW']. Defaults to 'SGD'.
    sync_bn (bool, optional): Use synchronized BatchNorm, only available in DDP mode. Defaults to False.
    workers (int, optional): Maximum dataloader workers per rank in DDP mode. Defaults to 8.
    project (str, optional): Directory for saving training runs. Defaults to ROOT / 'runs/train'.
    name (str, optional): Name for saving the training run. Defaults to 'exp'.
    exist_ok (bool, optional): Allow existing project/name without incrementing. Defaults to False.
    quad (bool, optional): Use quad dataloader. Defaults to False.
    cos_lr (bool, optional): Use cosine learning rate scheduler. Defaults to False.
    label_smoothing (float, optional): Label smoothing epsilon value. Defaults to 0.0.
    patience (int, optional): Patience for early stopping, measured in epochs without improvement. Defaults to 100.
    freeze (list, optional): Layers to freeze, e.g., backbone=10, first 3 layers = [0, 1, 2]. Defaults to [0].
    save_period (int, optional): Frequency in epochs to save checkpoints. Disabled if < 1. Defaults to -1.
    seed (int, optional): Global training random seed. Defaults to 0.
    local_rank (int, optional): Automatic DDP Multi-GPU argument. Do not modify. Defaults to -1.

Returns:
    None: The function initiates YOLOv5 training or hyperparameter evolution based on the provided options.

Examples:
    ```python
    import train
    train.run(data='coco128.yaml', imgsz=320, weights='yolov5m.pt')
    ```

Notes:
    - Models: https://github.com/ultralytics/yolov5/tree/master/models
    - Datasets: https://github.com/ultralytics/yolov5/tree/master/data
    - Tutorial: https://docs.ultralytics.com/yolov5/tutorials/train_custom_data
\end{DoxyVerb}
 \Hypertarget{namespacetrain_a165c8db7d0d098f2da9f04f83eb4a443}\index{train@{train}!train@{train}}
\index{train@{train}!train@{train}}
\doxysubsubsection{\texorpdfstring{train()}{train()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily \label{namespacetrain_a165c8db7d0d098f2da9f04f83eb4a443} 
train.\+train (\begin{DoxyParamCaption}\item[{}]{hyp}{, }\item[{}]{opt}{, }\item[{}]{device}{, }\item[{}]{callbacks}{}\end{DoxyParamCaption})}

\begin{DoxyVerb}Trains the YOLOv5 model on a dataset, managing hyperparameters, model optimization, logging, and validation.

`hyp` is path/to/hyp.yaml or hyp dictionary.
\end{DoxyVerb}


\begin{DoxyVerb}Train a YOLOv5 model on a custom dataset using specified hyperparameters, options, and device, managing datasets,
model architecture, loss computation, and optimizer steps.

Args:
    hyp (str | dict): Path to the hyperparameters YAML file or a dictionary of hyperparameters.
    opt (argparse.Namespace): Parsed command-line arguments containing training options.
    device (torch.device): Device on which training occurs, e.g., 'cuda' or 'cpu'.
    callbacks (Callbacks): Callback functions for various training events.

Returns:
    None

Models and datasets download automatically from the latest YOLOv5 release.

Example:
    Single-GPU training:
    ```bash
    $ python train.py --data coco128.yaml --weights yolov5s.pt --img 640  # from pretrained (recommended)
    $ python train.py --data coco128.yaml --weights '' --cfg yolov5s.yaml --img 640  # from scratch
    ```

    Multi-GPU DDP training:
    ```bash
    $ python -m torch.distributed.run --nproc_per_node 4 --master_port 1 train.py --data coco128.yaml --weights
    yolov5s.pt --img 640 --device 0,1,2,3
    ```

    For more usage details, refer to:
    - Models: https://github.com/ultralytics/yolov5/tree/master/models
    - Datasets: https://github.com/ultralytics/yolov5/tree/master/data
    - Tutorial: https://docs.ultralytics.com/yolov5/tutorials/train_custom_data
\end{DoxyVerb}
 \Hypertarget{namespacetrain_aff3e936230788ec1ff45538929277533}\index{train@{train}!train@{train}}
\index{train@{train}!train@{train}}
\doxysubsubsection{\texorpdfstring{train()}{train()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily \label{namespacetrain_aff3e936230788ec1ff45538929277533} 
train.\+train (\begin{DoxyParamCaption}\item[{}]{opt}{, }\item[{}]{device}{}\end{DoxyParamCaption})}

\begin{DoxyVerb}Trains a YOLOv5 model, managing datasets, model optimization, logging, and saving checkpoints.\end{DoxyVerb}
 

\doxysubsection{Variable Documentation}
\Hypertarget{namespacetrain_a64cf27375407e6f7fedc86c8a87dc636}\index{train@{train}!comet\_ml@{comet\_ml}}
\index{comet\_ml@{comet\_ml}!train@{train}}
\doxysubsubsection{\texorpdfstring{comet\_ml}{comet\_ml}}
{\footnotesize\ttfamily \label{namespacetrain_a64cf27375407e6f7fedc86c8a87dc636} 
train.\+comet\+\_\+ml = None}

\Hypertarget{namespacetrain_add74d372d0a1ebe4092c91d501f92034}\index{train@{train}!FILE@{FILE}}
\index{FILE@{FILE}!train@{train}}
\doxysubsubsection{\texorpdfstring{FILE}{FILE}}
{\footnotesize\ttfamily \label{namespacetrain_add74d372d0a1ebe4092c91d501f92034} 
train.\+FILE = Path(\+\_\+\+\_\+file\+\_\+\+\_\+).resolve()}

\Hypertarget{namespacetrain_ae603c070a3f7f6ce8fea4b0e4148135b}\index{train@{train}!GIT\_INFO@{GIT\_INFO}}
\index{GIT\_INFO@{GIT\_INFO}!train@{train}}
\doxysubsubsection{\texorpdfstring{GIT\_INFO}{GIT\_INFO}}
{\footnotesize\ttfamily \label{namespacetrain_ae603c070a3f7f6ce8fea4b0e4148135b} 
train.\+GIT\+\_\+\+INFO = check\+\_\+git\+\_\+info()}

\Hypertarget{namespacetrain_abc52041aeca5611a7d219e612c36a7b2}\index{train@{train}!LOCAL\_RANK@{LOCAL\_RANK}}
\index{LOCAL\_RANK@{LOCAL\_RANK}!train@{train}}
\doxysubsubsection{\texorpdfstring{LOCAL\_RANK}{LOCAL\_RANK}}
{\footnotesize\ttfamily \label{namespacetrain_abc52041aeca5611a7d219e612c36a7b2} 
train.\+LOCAL\+\_\+\+RANK = int(os.\+getenv("{}LOCAL\+\_\+\+RANK"{}, -\/1))}

\Hypertarget{namespacetrain_a8ce47f3ce85e34ed945573b80e08aaf6}\index{train@{train}!opt@{opt}}
\index{opt@{opt}!train@{train}}
\doxysubsubsection{\texorpdfstring{opt}{opt}}
{\footnotesize\ttfamily \label{namespacetrain_a8ce47f3ce85e34ed945573b80e08aaf6} 
train.\+opt = \mbox{\hyperlink{namespacetrain_a3c7f10b4f480ab5baa3739aafc54a490}{parse\+\_\+opt}}()}

\Hypertarget{namespacetrain_a6dd13c1a6cf9587741f3de1e8339b7c1}\index{train@{train}!RANK@{RANK}}
\index{RANK@{RANK}!train@{train}}
\doxysubsubsection{\texorpdfstring{RANK}{RANK}}
{\footnotesize\ttfamily \label{namespacetrain_a6dd13c1a6cf9587741f3de1e8339b7c1} 
train.\+RANK = int(os.\+getenv("{}RANK"{}, -\/1))}

\Hypertarget{namespacetrain_aa1aebe5c6044ab0d9f4eb2f387439700}\index{train@{train}!ROOT@{ROOT}}
\index{ROOT@{ROOT}!train@{train}}
\doxysubsubsection{\texorpdfstring{ROOT}{ROOT}}
{\footnotesize\ttfamily \label{namespacetrain_aa1aebe5c6044ab0d9f4eb2f387439700} 
train.\+ROOT = FILE.\+parents\mbox{[}1\mbox{]}}

\Hypertarget{namespacetrain_aae43f9902f6ea4d5d5603f84d2e8212c}\index{train@{train}!WORLD\_SIZE@{WORLD\_SIZE}}
\index{WORLD\_SIZE@{WORLD\_SIZE}!train@{train}}
\doxysubsubsection{\texorpdfstring{WORLD\_SIZE}{WORLD\_SIZE}}
{\footnotesize\ttfamily \label{namespacetrain_aae43f9902f6ea4d5d5603f84d2e8212c} 
train.\+WORLD\+\_\+\+SIZE = int(os.\+getenv("{}WORLD\+\_\+\+SIZE"{}, 1))}

