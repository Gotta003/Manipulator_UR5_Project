\doxysection{export Namespace Reference}
\hypertarget{namespaceexport}{}\label{namespaceexport}\index{export@{export}}
\doxysubsubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \mbox{\hyperlink{classexport_1_1i_o_s_model}{i\+OSModel}}
\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespaceexport_a7b6acfbbcfc1f6745013f12b2b35d076}{export\+\_\+formats}} ()
\item 
\mbox{\hyperlink{namespaceexport_a9bb3a1917c1d3e4ec85b29d77d97d79d}{try\+\_\+export}} (inner\+\_\+func)
\item 
\mbox{\hyperlink{namespaceexport_adadb7c311af985b4f06ecf589d8adb49}{export\+\_\+torchscript}} (model, im, file, optimize, prefix=colorstr("{}Torch\+Script\+:"{}))
\item 
\mbox{\hyperlink{namespaceexport_abb3dc2a3d12fd1101ba10b1a47c70ede}{export\+\_\+onnx}} (model, im, file, opset, dynamic, simplify, prefix=colorstr("{}ONNX\+:"{}))
\item 
\mbox{\hyperlink{namespaceexport_a963a08d07b85e362e555c050c3437c38}{export\+\_\+openvino}} (file, metadata, half, int8, data, prefix=colorstr("{}Open\+VINO\+:"{}))
\item 
\mbox{\hyperlink{namespaceexport_aba065557194a9291e9758f9101597e0c}{export\+\_\+paddle}} (model, im, file, metadata, prefix=colorstr("{}Paddle\+Paddle\+:"{}))
\item 
\mbox{\hyperlink{namespaceexport_a7e564216557921a3722d40c77c493ba9}{export\+\_\+coreml}} (model, im, file, int8, half, nms, mlmodel, prefix=colorstr("{}Core\+ML\+:"{}))
\item 
\mbox{\hyperlink{namespaceexport_a60d92d2d8896aa312f140c285be0235f}{export\+\_\+engine}} (model, im, file, half, dynamic, simplify, workspace=4, verbose=False, cache="{}"{}, prefix=colorstr("{}Tensor\+RT\+:"{}))
\item 
\mbox{\hyperlink{namespaceexport_afabd6fdeff977572cf9529502a92657b}{export\+\_\+saved\+\_\+model}} (model, im, file, dynamic, tf\+\_\+nms=False, agnostic\+\_\+nms=False, topk\+\_\+per\+\_\+class=100, topk\+\_\+all=100, iou\+\_\+thres=0.\+45, conf\+\_\+thres=0.\+25, keras=False, prefix=colorstr("{}Tensor\+Flow Saved\+Model\+:"{}))
\item 
\mbox{\hyperlink{namespaceexport_af52a530cf55ac3e6084d5a0270be3161}{export\+\_\+pb}} (keras\+\_\+model, file, prefix=colorstr("{}Tensor\+Flow Graph\+Def\+:"{}))
\item 
\mbox{\hyperlink{namespaceexport_ac70636b57505b3f0568cb72e2d04540e}{export\+\_\+tflite}} (keras\+\_\+model, im, file, int8, per\+\_\+tensor, data, nms, agnostic\+\_\+nms, prefix=colorstr("{}Tensor\+Flow Lite\+:"{}))
\item 
\mbox{\hyperlink{namespaceexport_aef30ff998891380cf03de8792b674f45}{export\+\_\+edgetpu}} (file, prefix=colorstr("{}Edge TPU\+:"{}))
\item 
\mbox{\hyperlink{namespaceexport_aa89001f2be84d4ee53ca792f740ccfa6}{export\+\_\+tfjs}} (file, int8, prefix=colorstr("{}Tensor\+Flow.\+js\+:"{}))
\item 
\mbox{\hyperlink{namespaceexport_aaed22892b03c0d8f3982c80fed3f540c}{add\+\_\+tflite\+\_\+metadata}} (file, metadata, num\+\_\+outputs)
\item 
\mbox{\hyperlink{namespaceexport_a74d0b79924fb71434e04a6e8a8682dee}{pipeline\+\_\+coreml}} (model, im, file, names, y, mlmodel, prefix=colorstr("{}Core\+ML Pipeline\+:"{}))
\item 
\mbox{\hyperlink{namespaceexport_a0849a20a94d07087af749a04088c6bec}{run}} (data=\mbox{\hyperlink{namespaceexport_aa2a435b13a4c49dde8c5c3f389bdd2d5}{ROOT}}/"{}data/coco128.\+yaml"{}, weights=\mbox{\hyperlink{namespaceexport_aa2a435b13a4c49dde8c5c3f389bdd2d5}{ROOT}}/"{}yolov5s.\+pt"{}, imgsz=(640, 640), batch\+\_\+size=1, device="{}cpu"{}, include=("{}torchscript"{}, "{}onnx"{}), half=False, inplace=False, keras=False, optimize=False, int8=False, per\+\_\+tensor=False, dynamic=False, cache="{}"{}, simplify=False, mlmodel=False, opset=12, verbose=False, workspace=4, nms=False, agnostic\+\_\+nms=False, topk\+\_\+per\+\_\+class=100, topk\+\_\+all=100, iou\+\_\+thres=0.\+45, conf\+\_\+thres=0.\+25)
\item 
\mbox{\hyperlink{namespaceexport_a7b4d8d1164f643274a56d56ad458f35b}{parse\+\_\+opt}} (known=False)
\item 
\mbox{\hyperlink{namespaceexport_a01b624c9227a1cbe0e73b11ed4654267}{main}} (\mbox{\hyperlink{namespaceexport_a0d9efe06403dd5221657e8ff6c0230ca}{opt}})
\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespaceexport_a9bfae37ca15b3f687b2907c4b6fa38c5}{FILE}} = Path(\+\_\+\+\_\+file\+\_\+\+\_\+).resolve()
\item 
\mbox{\hyperlink{namespaceexport_aa2a435b13a4c49dde8c5c3f389bdd2d5}{ROOT}} = FILE.\+parents\mbox{[}0\mbox{]}
\item 
str \mbox{\hyperlink{namespaceexport_a29e5fa5781007b2f0a95df7c46cd4979}{MACOS}} = "{}Darwin"{}
\item 
\mbox{\hyperlink{namespaceexport_a0d9efe06403dd5221657e8ff6c0230ca}{opt}} = \mbox{\hyperlink{namespaceexport_a7b4d8d1164f643274a56d56ad458f35b}{parse\+\_\+opt}}()
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\begin{DoxyVerb}Export a YOLOv5 PyTorch model to other formats. TensorFlow exports authored by https://github.com/zldrobit.

Format                      | `export.py --include`         | Model
---                         | ---                           | ---
PyTorch                     | -                             | yolov5s.pt
TorchScript                 | `torchscript`                 | yolov5s.torchscript
ONNX                        | `onnx`                        | yolov5s.onnx
OpenVINO                    | `openvino`                    | yolov5s_openvino_model/
TensorRT                    | `engine`                      | yolov5s.engine
CoreML                      | `coreml`                      | yolov5s.mlmodel
TensorFlow SavedModel       | `saved_model`                 | yolov5s_saved_model/
TensorFlow GraphDef         | `pb`                          | yolov5s.pb
TensorFlow Lite             | `tflite`                      | yolov5s.tflite
TensorFlow Edge TPU         | `edgetpu`                     | yolov5s_edgetpu.tflite
TensorFlow.js               | `tfjs`                        | yolov5s_web_model/
PaddlePaddle                | `paddle`                      | yolov5s_paddle_model/

Requirements:
    $ pip install -r requirements.txt coremltools onnx onnx-simplifier onnxruntime openvino-dev tensorflow-cpu  # CPU
    $ pip install -r requirements.txt coremltools onnx onnx-simplifier onnxruntime-gpu openvino-dev tensorflow  # GPU

Usage:
    $ python export.py --weights yolov5s.pt --include torchscript onnx openvino engine coreml tflite ...

Inference:
    $ python detect.py --weights yolov5s.pt                 # PyTorch
                                 yolov5s.torchscript        # TorchScript
                                 yolov5s.onnx               # ONNX Runtime or OpenCV DNN with --dnn
                                 yolov5s_openvino_model     # OpenVINO
                                 yolov5s.engine             # TensorRT
                                 yolov5s.mlmodel            # CoreML (macOS-only)
                                 yolov5s_saved_model        # TensorFlow SavedModel
                                 yolov5s.pb                 # TensorFlow GraphDef
                                 yolov5s.tflite             # TensorFlow Lite
                                 yolov5s_edgetpu.tflite     # TensorFlow Edge TPU
                                 yolov5s_paddle_model       # PaddlePaddle

TensorFlow.js:
    $ cd .. && git clone https://github.com/zldrobit/tfjs-yolov5-example.git && cd tfjs-yolov5-example
    $ npm install
    $ ln -s ../../yolov5/yolov5s_web_model public/yolov5s_web_model
    $ npm start
\end{DoxyVerb}
 

\doxysubsection{Function Documentation}
\Hypertarget{namespaceexport_aaed22892b03c0d8f3982c80fed3f540c}\index{export@{export}!add\_tflite\_metadata@{add\_tflite\_metadata}}
\index{add\_tflite\_metadata@{add\_tflite\_metadata}!export@{export}}
\doxysubsubsection{\texorpdfstring{add\_tflite\_metadata()}{add\_tflite\_metadata()}}
{\footnotesize\ttfamily \label{namespaceexport_aaed22892b03c0d8f3982c80fed3f540c} 
export.\+add\+\_\+tflite\+\_\+metadata (\begin{DoxyParamCaption}\item[{}]{file}{, }\item[{}]{metadata}{, }\item[{}]{num\+\_\+outputs}{}\end{DoxyParamCaption})}

\begin{DoxyVerb}Adds metadata to a TensorFlow Lite (TFLite) model file, supporting multiple outputs according to TensorFlow
guidelines.

Args:
    file (str): Path to the TFLite model file to which metadata will be added.
    metadata (dict): Metadata information to be added to the model, structured as required by the TFLite metadata schema.
        Common keys include "name", "description", "version", "author", and "license".
    num_outputs (int): Number of output tensors the model has, used to configure the metadata properly.

Returns:
    None

Example:
    ```python
    metadata = {
        "name": "yolov5",
        "description": "YOLOv5 object detection model",
        "version": "1.0",
        "author": "Ultralytics",
        "license": "Apache License 2.0"
    }
    add_tflite_metadata("model.tflite", metadata, num_outputs=4)
    ```

Note:
    TFLite metadata can include information such as model name, version, author, and other relevant details.
    For more details on the structure of the metadata, refer to TensorFlow Lite
    [metadata guidelines](https://www.tensorflow.org/lite/models/convert/metadata).
\end{DoxyVerb}
 \Hypertarget{namespaceexport_a7e564216557921a3722d40c77c493ba9}\index{export@{export}!export\_coreml@{export\_coreml}}
\index{export\_coreml@{export\_coreml}!export@{export}}
\doxysubsubsection{\texorpdfstring{export\_coreml()}{export\_coreml()}}
{\footnotesize\ttfamily \label{namespaceexport_a7e564216557921a3722d40c77c493ba9} 
export.\+export\+\_\+coreml (\begin{DoxyParamCaption}\item[{}]{model}{, }\item[{}]{im}{, }\item[{}]{file}{, }\item[{}]{int8}{, }\item[{}]{half}{, }\item[{}]{nms}{, }\item[{}]{mlmodel}{, }\item[{}]{prefix}{ = {\ttfamily colorstr("{}CoreML\+:"{})}}\end{DoxyParamCaption})}

\begin{DoxyVerb}Export a YOLOv5 model to CoreML format with optional NMS, INT8, and FP16 support.

Args:
    model (torch.nn.Module): The YOLOv5 model to be exported.
    im (torch.Tensor): Example input tensor to trace the model.
    file (pathlib.Path): Path object where the CoreML model will be saved.
    int8 (bool): Flag indicating whether to use INT8 quantization (default is False).
    half (bool): Flag indicating whether to use FP16 quantization (default is False).
    nms (bool): Flag indicating whether to include Non-Maximum Suppression (default is False).
    mlmodel (bool): Flag indicating whether to export as older *.mlmodel format (default is False).
    prefix (str): Prefix string for logging purposes (default is 'CoreML:').

Returns:
    tuple[pathlib.Path | None, None]: The path to the saved CoreML model file, or (None, None) if there is an error.

Notes:
    The exported CoreML model will be saved with a .mlmodel extension.
    Quantization is supported only on macOS.

Example:
    ```python
    from pathlib import Path
    import torch
    from models.yolo import Model
    model = Model(cfg, ch=3, nc=80)
    im = torch.randn(1, 3, 640, 640)
    file = Path("yolov5s_coreml")
    export_coreml(model, im, file, int8=False, half=False, nms=True, mlmodel=False)
    ```
\end{DoxyVerb}
 \Hypertarget{namespaceexport_aef30ff998891380cf03de8792b674f45}\index{export@{export}!export\_edgetpu@{export\_edgetpu}}
\index{export\_edgetpu@{export\_edgetpu}!export@{export}}
\doxysubsubsection{\texorpdfstring{export\_edgetpu()}{export\_edgetpu()}}
{\footnotesize\ttfamily \label{namespaceexport_aef30ff998891380cf03de8792b674f45} 
export.\+export\+\_\+edgetpu (\begin{DoxyParamCaption}\item[{}]{file}{, }\item[{}]{prefix}{ = {\ttfamily colorstr("{}Edge~TPU\+:"{})}}\end{DoxyParamCaption})}

\begin{DoxyVerb}Exports a YOLOv5 model to Edge TPU compatible TFLite format; requires Linux and Edge TPU compiler.

Args:
    file (Path): Path to the YOLOv5 model file to be exported (.pt format).
    prefix (str, optional): Prefix for logging messages. Defaults to colorstr("Edge TPU:").

Returns:
    tuple[Path, None]: Path to the exported Edge TPU compatible TFLite model, None.

Raises:
    AssertionError: If the system is not Linux.
    subprocess.CalledProcessError: If any subprocess call to install or run the Edge TPU compiler fails.

Notes:
    To use this function, ensure you have the Edge TPU compiler installed on your Linux system. You can find
    installation instructions here: https://coral.ai/docs/edgetpu/compiler/.

Example:
    ```python
    from pathlib import Path
    file = Path('yolov5s.pt')
    export_edgetpu(file)
    ```
\end{DoxyVerb}
 \Hypertarget{namespaceexport_a60d92d2d8896aa312f140c285be0235f}\index{export@{export}!export\_engine@{export\_engine}}
\index{export\_engine@{export\_engine}!export@{export}}
\doxysubsubsection{\texorpdfstring{export\_engine()}{export\_engine()}}
{\footnotesize\ttfamily \label{namespaceexport_a60d92d2d8896aa312f140c285be0235f} 
export.\+export\+\_\+engine (\begin{DoxyParamCaption}\item[{}]{model}{, }\item[{}]{im}{, }\item[{}]{file}{, }\item[{}]{half}{, }\item[{}]{dynamic}{, }\item[{}]{simplify}{, }\item[{}]{workspace}{ = {\ttfamily 4}, }\item[{}]{verbose}{ = {\ttfamily False}, }\item[{}]{cache}{ = {\ttfamily "{}"{}}, }\item[{}]{prefix}{ = {\ttfamily colorstr("{}TensorRT\+:"{})}}\end{DoxyParamCaption})}

\begin{DoxyVerb}Export a YOLOv5 model to TensorRT engine format, requiring GPU and TensorRT>=7.0.0.

Args:
    model (torch.nn.Module): YOLOv5 model to be exported.
    im (torch.Tensor): Input tensor of shape (B, C, H, W).
    file (pathlib.Path): Path to save the exported model.
    half (bool): Set to True to export with FP16 precision.
    dynamic (bool): Set to True to enable dynamic input shapes.
    simplify (bool): Set to True to simplify the model during export.
    workspace (int): Workspace size in GB (default is 4).
    verbose (bool): Set to True for verbose logging output.
    cache (str): Path to save the TensorRT timing cache.
    prefix (str): Log message prefix.

Returns:
    (pathlib.Path, None): Tuple containing the path to the exported model and None.

Raises:
    AssertionError: If executed on CPU instead of GPU.
    RuntimeError: If there is a failure in parsing the ONNX file.

Example:
    ```python
    from ultralytics import YOLOv5
    import torch
    from pathlib import Path

    model = YOLOv5('yolov5s.pt')  # Load a pre-trained YOLOv5 model
    input_tensor = torch.randn(1, 3, 640, 640).cuda()  # example input tensor on GPU
    export_path = Path('yolov5s.engine')  # export destination

    export_engine(model.model, input_tensor, export_path, half=True, dynamic=True, simplify=True, workspace=8, verbose=True)
    ```
\end{DoxyVerb}
 \Hypertarget{namespaceexport_a7b6acfbbcfc1f6745013f12b2b35d076}\index{export@{export}!export\_formats@{export\_formats}}
\index{export\_formats@{export\_formats}!export@{export}}
\doxysubsubsection{\texorpdfstring{export\_formats()}{export\_formats()}}
{\footnotesize\ttfamily \label{namespaceexport_a7b6acfbbcfc1f6745013f12b2b35d076} 
export.\+export\+\_\+formats (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})}

\begin{DoxyVerb}Returns a DataFrame of supported YOLOv5 model export formats and their properties.

Returns:
pandas.DataFrame: A DataFrame containing supported export formats and their properties. The DataFrame
includes columns for format name, CLI argument suffix, file extension or directory name, and boolean flags
indicating if the export format supports training and detection.

Examples:
```python
formats = export_formats()
print(f"Supported export formats:\n{formats}")
```

Notes:
The DataFrame contains the following columns:
- Format: The name of the model format (e.g., PyTorch, TorchScript, ONNX, etc.).
- Include Argument: The argument to use with the export script to include this format.
- File Suffix: File extension or directory name associated with the format.
- Supports Training: Whether the format supports training.
- Supports Detection: Whether the format supports detection.
\end{DoxyVerb}
 \Hypertarget{namespaceexport_abb3dc2a3d12fd1101ba10b1a47c70ede}\index{export@{export}!export\_onnx@{export\_onnx}}
\index{export\_onnx@{export\_onnx}!export@{export}}
\doxysubsubsection{\texorpdfstring{export\_onnx()}{export\_onnx()}}
{\footnotesize\ttfamily \label{namespaceexport_abb3dc2a3d12fd1101ba10b1a47c70ede} 
export.\+export\+\_\+onnx (\begin{DoxyParamCaption}\item[{}]{model}{, }\item[{}]{im}{, }\item[{}]{file}{, }\item[{}]{opset}{, }\item[{}]{dynamic}{, }\item[{}]{simplify}{, }\item[{}]{prefix}{ = {\ttfamily colorstr("{}ONNX\+:"{})}}\end{DoxyParamCaption})}

\begin{DoxyVerb}Export a YOLOv5 model to ONNX format with dynamic axes support and optional model simplification.

Args:
    model (torch.nn.Module): The YOLOv5 model to be exported.
    im (torch.Tensor): A sample input tensor for model tracing, usually the shape is (1, 3, height, width).
    file (pathlib.Path | str): The output file path where the ONNX model will be saved.
    opset (int): The ONNX opset version to use for export.
    dynamic (bool): If True, enables dynamic axes for batch, height, and width dimensions.
    simplify (bool): If True, applies ONNX model simplification for optimization.
    prefix (str): A prefix string for logging messages, defaults to 'ONNX:'.

Returns:
    tuple[pathlib.Path | str, None]: The path to the saved ONNX model file and None (consistent with decorator).

Raises:
    ImportError: If required libraries for export (e.g., 'onnx', 'onnx-simplifier') are not installed.
    AssertionError: If the simplification check fails.

Notes:
    The required packages for this function can be installed via:
    ```
    pip install onnx onnx-simplifier onnxruntime onnxruntime-gpu
    ```

Example:
    ```python
    from pathlib import Path
    import torch
    from models.experimental import attempt_load
    from utils.torch_utils import select_device

    # Load model
    weights = 'yolov5s.pt'
    device = select_device('')
    model = attempt_load(weights, map_location=device)

    # Example input tensor
    im = torch.zeros(1, 3, 640, 640).to(device)

    # Export model
    file_path = Path('yolov5s.onnx')
    export_onnx(model, im, file_path, opset=12, dynamic=True, simplify=True)
    ```
\end{DoxyVerb}
 \Hypertarget{namespaceexport_a963a08d07b85e362e555c050c3437c38}\index{export@{export}!export\_openvino@{export\_openvino}}
\index{export\_openvino@{export\_openvino}!export@{export}}
\doxysubsubsection{\texorpdfstring{export\_openvino()}{export\_openvino()}}
{\footnotesize\ttfamily \label{namespaceexport_a963a08d07b85e362e555c050c3437c38} 
export.\+export\+\_\+openvino (\begin{DoxyParamCaption}\item[{}]{file}{, }\item[{}]{metadata}{, }\item[{}]{half}{, }\item[{}]{int8}{, }\item[{}]{data}{, }\item[{}]{prefix}{ = {\ttfamily colorstr("{}OpenVINO\+:"{})}}\end{DoxyParamCaption})}

\begin{DoxyVerb}Export a YOLOv5 model to OpenVINO format with optional FP16 and INT8 quantization.

Args:
    file (Path): Path to the output file where the OpenVINO model will be saved.
    metadata (dict): Dictionary including model metadata such as names and strides.
    half (bool): If True, export the model with FP16 precision.
    int8 (bool): If True, export the model with INT8 quantization.
    data (str): Path to the dataset YAML file required for INT8 quantization.
    prefix (str): Prefix string for logging purposes (default is "OpenVINO:").

Returns:
    (str, openvino.runtime.Model | None): The OpenVINO model file path and openvino.runtime.Model object if export is
        successful; otherwise, None.

Notes:
    - Requires `openvino-dev` package version 2023.0 or higher. Install with:
      `$ pip install openvino-dev>=2023.0`
    - For INT8 quantization, also requires `nncf` library version 2.5.0 or higher. Install with:
      `$ pip install nncf>=2.5.0`

Examples:
    ```python
    from pathlib import Path
    from ultralytics import YOLOv5

    model = YOLOv5('yolov5s.pt')
    export_openvino(Path('yolov5s.onnx'), metadata={'names': model.names, 'stride': model.stride}, half=True,
                    int8=False, data='data.yaml')
    ```

    This will export the YOLOv5 model to OpenVINO with FP16 precision but without INT8 quantization, saving it to
    the specified file path.
\end{DoxyVerb}
 \Hypertarget{namespaceexport_aba065557194a9291e9758f9101597e0c}\index{export@{export}!export\_paddle@{export\_paddle}}
\index{export\_paddle@{export\_paddle}!export@{export}}
\doxysubsubsection{\texorpdfstring{export\_paddle()}{export\_paddle()}}
{\footnotesize\ttfamily \label{namespaceexport_aba065557194a9291e9758f9101597e0c} 
export.\+export\+\_\+paddle (\begin{DoxyParamCaption}\item[{}]{model}{, }\item[{}]{im}{, }\item[{}]{file}{, }\item[{}]{metadata}{, }\item[{}]{prefix}{ = {\ttfamily colorstr("{}PaddlePaddle\+:"{})}}\end{DoxyParamCaption})}

\begin{DoxyVerb}Export a YOLOv5 PyTorch model to PaddlePaddle format using X2Paddle, saving the converted model and metadata.

Args:
    model (torch.nn.Module): The YOLOv5 model to be exported.
    im (torch.Tensor): Input tensor used for model tracing during export.
    file (pathlib.Path): Path to the source file to be converted.
    metadata (dict): Additional metadata to be saved alongside the model.
    prefix (str): Prefix for logging information.

Returns:
    tuple (str, None): A tuple where the first element is the path to the saved PaddlePaddle model, and the
    second element is None.

Examples:
    ```python
    from pathlib import Path
    import torch

    # Assume 'model' is a pre-trained YOLOv5 model and 'im' is an example input tensor
    model = ...  # Load your model here
    im = torch.randn((1, 3, 640, 640))  # Dummy input tensor for tracing
    file = Path("yolov5s.pt")
    metadata = {"stride": 32, "names": ["person", "bicycle", "car", "motorbike"]}

    export_paddle(model=model, im=im, file=file, metadata=metadata)
    ```

Notes:
    Ensure that `paddlepaddle` and `x2paddle` are installed, as these are required for the export function. You can
    install them via pip:
    ```
    $ pip install paddlepaddle x2paddle
    ```
\end{DoxyVerb}
 \Hypertarget{namespaceexport_af52a530cf55ac3e6084d5a0270be3161}\index{export@{export}!export\_pb@{export\_pb}}
\index{export\_pb@{export\_pb}!export@{export}}
\doxysubsubsection{\texorpdfstring{export\_pb()}{export\_pb()}}
{\footnotesize\ttfamily \label{namespaceexport_af52a530cf55ac3e6084d5a0270be3161} 
export.\+export\+\_\+pb (\begin{DoxyParamCaption}\item[{}]{keras\+\_\+model}{, }\item[{}]{file}{, }\item[{}]{prefix}{ = {\ttfamily colorstr("{}TensorFlow~GraphDef\+:"{})}}\end{DoxyParamCaption})}

\begin{DoxyVerb}Export YOLOv5 model to TensorFlow GraphDef (*.pb) format.

Args:
    keras_model (tf.keras.Model): The Keras model to be converted.
    file (Path): The output file path where the GraphDef will be saved.
    prefix (str): Optional prefix string; defaults to a colored string indicating TensorFlow GraphDef export status.

Returns:
    Tuple[Path, None]: The file path where the GraphDef model was saved and a None placeholder.

Notes:
    For more details, refer to the guide on frozen graphs: https://github.com/leimao/Frozen_Graph_TensorFlow

Example:
    ```python
    from pathlib import Path
    keras_model = ...  # assume an existing Keras model
    file = Path("model.pb")
    export_pb(keras_model, file)
    ```
\end{DoxyVerb}
 \Hypertarget{namespaceexport_afabd6fdeff977572cf9529502a92657b}\index{export@{export}!export\_saved\_model@{export\_saved\_model}}
\index{export\_saved\_model@{export\_saved\_model}!export@{export}}
\doxysubsubsection{\texorpdfstring{export\_saved\_model()}{export\_saved\_model()}}
{\footnotesize\ttfamily \label{namespaceexport_afabd6fdeff977572cf9529502a92657b} 
export.\+export\+\_\+saved\+\_\+model (\begin{DoxyParamCaption}\item[{}]{model}{, }\item[{}]{im}{, }\item[{}]{file}{, }\item[{}]{dynamic}{, }\item[{}]{tf\+\_\+nms}{ = {\ttfamily False}, }\item[{}]{agnostic\+\_\+nms}{ = {\ttfamily False}, }\item[{}]{topk\+\_\+per\+\_\+class}{ = {\ttfamily 100}, }\item[{}]{topk\+\_\+all}{ = {\ttfamily 100}, }\item[{}]{iou\+\_\+thres}{ = {\ttfamily 0.45}, }\item[{}]{conf\+\_\+thres}{ = {\ttfamily 0.25}, }\item[{}]{keras}{ = {\ttfamily False}, }\item[{}]{prefix}{ = {\ttfamily colorstr("{}TensorFlow~SavedModel\+:"{})}}\end{DoxyParamCaption})}

\begin{DoxyVerb}Export a YOLOv5 model to the TensorFlow SavedModel format, supporting dynamic axes and non-maximum suppression
(NMS).

Args:
    model (torch.nn.Module): The PyTorch model to convert.
    im (torch.Tensor): Sample input tensor with shape (B, C, H, W) for tracing.
    file (pathlib.Path): File path to save the exported model.
    dynamic (bool): Flag to indicate whether dynamic axes should be used.
    tf_nms (bool, optional): Enable TensorFlow non-maximum suppression (NMS). Default is False.
    agnostic_nms (bool, optional): Enable class-agnostic NMS. Default is False.
    topk_per_class (int, optional): Top K detections per class to keep before applying NMS. Default is 100.
    topk_all (int, optional): Top K detections across all classes to keep before applying NMS. Default is 100.
    iou_thres (float, optional): IoU threshold for NMS. Default is 0.45.
    conf_thres (float, optional): Confidence threshold for detections. Default is 0.25.
    keras (bool, optional): Save the model in Keras format if True. Default is False.
    prefix (str, optional): Prefix for logging messages. Default is "TensorFlow SavedModel:".

Returns:
    tuple[str, tf.keras.Model | None]: A tuple containing the path to the saved model folder and the Keras model instance,
    or None if TensorFlow export fails.

Notes:
    - The method supports TensorFlow versions up to 2.15.1.
    - TensorFlow NMS may not be supported in older TensorFlow versions.
    - If the TensorFlow version exceeds 2.13.1, it might cause issues when exporting to TFLite.
      Refer to: https://github.com/ultralytics/yolov5/issues/12489

Example:
    ```python
    model, im = ...  # Initialize your PyTorch model and input tensor
    export_saved_model(model, im, Path("yolov5_saved_model"), dynamic=True)
    ```
\end{DoxyVerb}
 \Hypertarget{namespaceexport_aa89001f2be84d4ee53ca792f740ccfa6}\index{export@{export}!export\_tfjs@{export\_tfjs}}
\index{export\_tfjs@{export\_tfjs}!export@{export}}
\doxysubsubsection{\texorpdfstring{export\_tfjs()}{export\_tfjs()}}
{\footnotesize\ttfamily \label{namespaceexport_aa89001f2be84d4ee53ca792f740ccfa6} 
export.\+export\+\_\+tfjs (\begin{DoxyParamCaption}\item[{}]{file}{, }\item[{}]{int8}{, }\item[{}]{prefix}{ = {\ttfamily colorstr("{}TensorFlow.js\+:"{})}}\end{DoxyParamCaption})}

\begin{DoxyVerb}Convert a YOLOv5 model to TensorFlow.js format with optional uint8 quantization.

Args:
    file (Path): Path to the YOLOv5 model file to be converted, typically having a ".pt" or ".onnx" extension.
    int8 (bool): If True, applies uint8 quantization during the conversion process.
    prefix (str): Optional prefix for logging messages, default is 'TensorFlow.js:' with color formatting.

Returns:
    (str, None): Tuple containing the output directory path as a string and None.

Notes:
    - This function requires the `tensorflowjs` package. Install it using:
      ```shell
      pip install tensorflowjs
      ```
    - The converted TensorFlow.js model will be saved in a directory with the "_web_model" suffix appended to the original file name.
    - The conversion involves running shell commands that invoke the TensorFlow.js converter tool.

Example:
    ```python
    from pathlib import Path
    file = Path('yolov5.onnx')
    export_tfjs(file, int8=False)
    ```
\end{DoxyVerb}
 \Hypertarget{namespaceexport_ac70636b57505b3f0568cb72e2d04540e}\index{export@{export}!export\_tflite@{export\_tflite}}
\index{export\_tflite@{export\_tflite}!export@{export}}
\doxysubsubsection{\texorpdfstring{export\_tflite()}{export\_tflite()}}
{\footnotesize\ttfamily \label{namespaceexport_ac70636b57505b3f0568cb72e2d04540e} 
export.\+export\+\_\+tflite (\begin{DoxyParamCaption}\item[{}]{keras\+\_\+model}{, }\item[{}]{im}{, }\item[{}]{file}{, }\item[{}]{int8}{, }\item[{}]{per\+\_\+tensor}{, }\item[{}]{data}{, }\item[{}]{nms}{, }\item[{}]{agnostic\+\_\+nms}{, }\item[{}]{prefix}{ = {\ttfamily colorstr("{}TensorFlow~Lite\+:"{})}}\end{DoxyParamCaption})}

\begin{DoxyVerb}Export a YOLOv5 model to TensorFlow Lite format with optional INT8 quantization and NMS support.

Args:
    keras_model (tf.keras.Model): The Keras model to be exported.
    im (torch.Tensor): An input image tensor for normalization and model tracing.
    file (Path): The file path to save the TensorFlow Lite model.
    int8 (bool): Enables INT8 quantization if True.
    per_tensor (bool): If True, disables per-channel quantization.
    data (str): Path to the dataset for representative dataset generation in INT8 quantization.
    nms (bool): Enables Non-Maximum Suppression (NMS) if True.
    agnostic_nms (bool): Enables class-agnostic NMS if True.
    prefix (str): Prefix for log messages.

Returns:
    (str | None, tflite.Model | None): The file path of the exported TFLite model and the TFLite model instance, or None
    if the export failed.

Example:
    ```python
    from pathlib import Path
    import torch
    import tensorflow as tf

    # Load a Keras model wrapping a YOLOv5 model
    keras_model = tf.keras.models.load_model('path/to/keras_model.h5')

    # Example input tensor
    im = torch.zeros(1, 3, 640, 640)

    # Export the model
    export_tflite(keras_model, im, Path('model.tflite'), int8=True, per_tensor=False, data='data/coco.yaml',
                  nms=True, agnostic_nms=False)
    ```

Notes:
    - Ensure TensorFlow and TensorFlow Lite dependencies are installed.
    - INT8 quantization requires a representative dataset to achieve optimal accuracy.
    - TensorFlow Lite models are suitable for efficient inference on mobile and edge devices.
\end{DoxyVerb}
 \Hypertarget{namespaceexport_adadb7c311af985b4f06ecf589d8adb49}\index{export@{export}!export\_torchscript@{export\_torchscript}}
\index{export\_torchscript@{export\_torchscript}!export@{export}}
\doxysubsubsection{\texorpdfstring{export\_torchscript()}{export\_torchscript()}}
{\footnotesize\ttfamily \label{namespaceexport_adadb7c311af985b4f06ecf589d8adb49} 
export.\+export\+\_\+torchscript (\begin{DoxyParamCaption}\item[{}]{model}{, }\item[{}]{im}{, }\item[{}]{file}{, }\item[{}]{optimize}{, }\item[{}]{prefix}{ = {\ttfamily colorstr("{}TorchScript\+:"{})}}\end{DoxyParamCaption})}

\begin{DoxyVerb}Export a YOLOv5 model to the TorchScript format.

Args:
    model (torch.nn.Module): The YOLOv5 model to be exported.
    im (torch.Tensor): Example input tensor to be used for tracing the TorchScript model.
    file (Path): File path where the exported TorchScript model will be saved.
    optimize (bool): If True, applies optimizations for mobile deployment.
    prefix (str): Optional prefix for log messages. Default is 'TorchScript:'.

Returns:
    (str | None, torch.jit.ScriptModule | None): A tuple containing the file path of the exported model
        (as a string) and the TorchScript model (as a torch.jit.ScriptModule). If the export fails, both elements
        of the tuple will be None.

Notes:
    - This function uses tracing to create the TorchScript model.
    - Metadata, including the input image shape, model stride, and class names, is saved in an extra file (`config.txt`)
      within the TorchScript model package.
    - For mobile optimization, refer to the PyTorch tutorial: https://pytorch.org/tutorials/recipes/mobile_interpreter.html

Example:
    ```python
    from pathlib import Path
    import torch
    from models.experimental import attempt_load
    from utils.torch_utils import select_device

    # Load model
    weights = 'yolov5s.pt'
    device = select_device('')
    model = attempt_load(weights, device=device)

    # Example input tensor
    im = torch.zeros(1, 3, 640, 640).to(device)

    # Export model
    file = Path('yolov5s.torchscript')
    export_torchscript(model, im, file, optimize=False)
    ```
\end{DoxyVerb}
 \Hypertarget{namespaceexport_a01b624c9227a1cbe0e73b11ed4654267}\index{export@{export}!main@{main}}
\index{main@{main}!export@{export}}
\doxysubsubsection{\texorpdfstring{main()}{main()}}
{\footnotesize\ttfamily \label{namespaceexport_a01b624c9227a1cbe0e73b11ed4654267} 
export.\+main (\begin{DoxyParamCaption}\item[{}]{opt}{}\end{DoxyParamCaption})}

\begin{DoxyVerb}Run(**vars(opt))  # Execute the run function with parsed options.\end{DoxyVerb}
 \Hypertarget{namespaceexport_a7b4d8d1164f643274a56d56ad458f35b}\index{export@{export}!parse\_opt@{parse\_opt}}
\index{parse\_opt@{parse\_opt}!export@{export}}
\doxysubsubsection{\texorpdfstring{parse\_opt()}{parse\_opt()}}
{\footnotesize\ttfamily \label{namespaceexport_a7b4d8d1164f643274a56d56ad458f35b} 
export.\+parse\+\_\+opt (\begin{DoxyParamCaption}\item[{}]{known}{ = {\ttfamily False}}\end{DoxyParamCaption})}

\begin{DoxyVerb}Parse command-line options for YOLOv5 model export configurations.

Args:
    known (bool): If True, uses `argparse.ArgumentParser.parse_known_args`; otherwise, uses `argparse.ArgumentParser.parse_args`.
                  Default is False.

Returns:
    argparse.Namespace: Object containing parsed command-line arguments.

Example:
    ```python
    opts = parse_opt()
    print(opts.data)
    print(opts.weights)
    ```
\end{DoxyVerb}
 \Hypertarget{namespaceexport_a74d0b79924fb71434e04a6e8a8682dee}\index{export@{export}!pipeline\_coreml@{pipeline\_coreml}}
\index{pipeline\_coreml@{pipeline\_coreml}!export@{export}}
\doxysubsubsection{\texorpdfstring{pipeline\_coreml()}{pipeline\_coreml()}}
{\footnotesize\ttfamily \label{namespaceexport_a74d0b79924fb71434e04a6e8a8682dee} 
export.\+pipeline\+\_\+coreml (\begin{DoxyParamCaption}\item[{}]{model}{, }\item[{}]{im}{, }\item[{}]{file}{, }\item[{}]{names}{, }\item[{}]{y}{, }\item[{}]{mlmodel}{, }\item[{}]{prefix}{ = {\ttfamily colorstr("{}CoreML~Pipeline\+:"{})}}\end{DoxyParamCaption})}

\begin{DoxyVerb}Convert a PyTorch YOLOv5 model to CoreML format with Non-Maximum Suppression (NMS), handling different input/output
shapes, and saving the model.

Args:
    model (torch.nn.Module): The YOLOv5 PyTorch model to be converted.
    im (torch.Tensor): Example input tensor with shape (N, C, H, W), where N is the batch size, C is the number of channels,
        H is the height, and W is the width.
    file (Path): Path to save the converted CoreML model.
    names (dict[int, str]): Dictionary mapping class indices to class names.
    y (torch.Tensor): Output tensor from the PyTorch model's forward pass.
    mlmodel (bool): Flag indicating whether to export as older *.mlmodel format (default is False).
    prefix (str): Custom prefix for logging messages.

Returns:
    (Path): Path to the saved CoreML model (.mlmodel).

Raises:
    AssertionError: If the number of class names does not match the number of classes in the model.

Notes:
    - This function requires `coremltools` to be installed.
    - Running this function on a non-macOS environment might not support some features.
    - Flexible input shapes and additional NMS options can be customized within the function.

Examples:
    ```python
    from pathlib import Path
    import torch

    model = torch.load('yolov5s.pt')  # Load YOLOv5 model
    im = torch.zeros((1, 3, 640, 640))  # Example input tensor

    names = {0: "person", 1: "bicycle", 2: "car", ...}  # Define class names

    y = model(im)  # Perform forward pass to get model output

    output_file = Path('yolov5s.mlmodel')  # Convert to CoreML
    pipeline_coreml(model, im, output_file, names, y)
    ```
\end{DoxyVerb}
 \Hypertarget{namespaceexport_a0849a20a94d07087af749a04088c6bec}\index{export@{export}!run@{run}}
\index{run@{run}!export@{export}}
\doxysubsubsection{\texorpdfstring{run()}{run()}}
{\footnotesize\ttfamily \label{namespaceexport_a0849a20a94d07087af749a04088c6bec} 
export.\+run (\begin{DoxyParamCaption}\item[{}]{data}{ = {\ttfamily \mbox{\hyperlink{namespaceexport_aa2a435b13a4c49dde8c5c3f389bdd2d5}{ROOT}}~/~"{}data/coco128.yaml"{}}, }\item[{}]{weights}{ = {\ttfamily \mbox{\hyperlink{namespaceexport_aa2a435b13a4c49dde8c5c3f389bdd2d5}{ROOT}}~/~"{}yolov5s.pt"{}}, }\item[{}]{imgsz}{ = {\ttfamily (640,~640)}, }\item[{}]{batch\+\_\+size}{ = {\ttfamily 1}, }\item[{}]{device}{ = {\ttfamily "{}cpu"{}}, }\item[{}]{include}{ = {\ttfamily ("{}torchscript"{},~"{}onnx"{})}, }\item[{}]{half}{ = {\ttfamily False}, }\item[{}]{inplace}{ = {\ttfamily False}, }\item[{}]{keras}{ = {\ttfamily False}, }\item[{}]{optimize}{ = {\ttfamily False}, }\item[{}]{int8}{ = {\ttfamily False}, }\item[{}]{per\+\_\+tensor}{ = {\ttfamily False}, }\item[{}]{dynamic}{ = {\ttfamily False}, }\item[{}]{cache}{ = {\ttfamily "{}"{}}, }\item[{}]{simplify}{ = {\ttfamily False}, }\item[{}]{mlmodel}{ = {\ttfamily False}, }\item[{}]{opset}{ = {\ttfamily 12}, }\item[{}]{verbose}{ = {\ttfamily False}, }\item[{}]{workspace}{ = {\ttfamily 4}, }\item[{}]{nms}{ = {\ttfamily False}, }\item[{}]{agnostic\+\_\+nms}{ = {\ttfamily False}, }\item[{}]{topk\+\_\+per\+\_\+class}{ = {\ttfamily 100}, }\item[{}]{topk\+\_\+all}{ = {\ttfamily 100}, }\item[{}]{iou\+\_\+thres}{ = {\ttfamily 0.45}, }\item[{}]{conf\+\_\+thres}{ = {\ttfamily 0.25}}\end{DoxyParamCaption})}

\begin{DoxyVerb}Exports a YOLOv5 model to specified formats including ONNX, TensorRT, CoreML, and TensorFlow.

Args:
    data (str | Path): Path to the dataset YAML configuration file. Default is 'data/coco128.yaml'.
    weights (str | Path): Path to the pretrained model weights file. Default is 'yolov5s.pt'.
    imgsz (tuple): Image size as (height, width). Default is (640, 640).
    batch_size (int): Batch size for exporting the model. Default is 1.
    device (str): Device to run the export on, e.g., '0' for GPU, 'cpu' for CPU. Default is 'cpu'.
    include (tuple): Formats to include in the export. Default is ('torchscript', 'onnx').
    half (bool): Flag to export model with FP16 half-precision. Default is False.
    inplace (bool): Set the YOLOv5 Detect() module inplace=True. Default is False.
    keras (bool): Flag to use Keras for TensorFlow SavedModel export. Default is False.
    optimize (bool): Optimize TorchScript model for mobile deployment. Default is False.
    int8 (bool): Apply INT8 quantization for CoreML or TensorFlow models. Default is False.
    per_tensor (bool): Apply per tensor quantization for TensorFlow models. Default is False.
    dynamic (bool): Enable dynamic axes for ONNX, TensorFlow, or TensorRT exports. Default is False.
    cache (str): TensorRT timing cache path. Default is an empty string.
    simplify (bool): Simplify the ONNX model during export. Default is False.
    opset (int): ONNX opset version. Default is 12.
    verbose (bool): Enable verbose logging for TensorRT export. Default is False.
    workspace (int): TensorRT workspace size in GB. Default is 4.
    nms (bool): Add non-maximum suppression (NMS) to the TensorFlow model. Default is False.
    agnostic_nms (bool): Add class-agnostic NMS to the TensorFlow model. Default is False.
    topk_per_class (int): Top-K boxes per class to keep for TensorFlow.js NMS. Default is 100.
    topk_all (int): Top-K boxes for all classes to keep for TensorFlow.js NMS. Default is 100.
    iou_thres (float): IoU threshold for NMS. Default is 0.45.
    conf_thres (float): Confidence threshold for NMS. Default is 0.25.
    mlmodel (bool): Flag to use *.mlmodel for CoreML export. Default is False.

Returns:
    None

Notes:
    - Model export is based on the specified formats in the 'include' argument.
    - Be cautious of combinations where certain flags are mutually exclusive, such as `--half` and `--dynamic`.

Example:
    ```python
    run(
        data="data/coco128.yaml",
        weights="yolov5s.pt",
        imgsz=(640, 640),
        batch_size=1,
        device="cpu",
        include=("torchscript", "onnx"),
        half=False,
        inplace=False,
        keras=False,
        optimize=False,
        int8=False,
        per_tensor=False,
        dynamic=False,
        cache="",
        simplify=False,
        opset=12,
        verbose=False,
        mlmodel=False,
        workspace=4,
        nms=False,
        agnostic_nms=False,
        topk_per_class=100,
        topk_all=100,
        iou_thres=0.45,
        conf_thres=0.25,
    )
    ```
\end{DoxyVerb}
 \Hypertarget{namespaceexport_a9bb3a1917c1d3e4ec85b29d77d97d79d}\index{export@{export}!try\_export@{try\_export}}
\index{try\_export@{try\_export}!export@{export}}
\doxysubsubsection{\texorpdfstring{try\_export()}{try\_export()}}
{\footnotesize\ttfamily \label{namespaceexport_a9bb3a1917c1d3e4ec85b29d77d97d79d} 
export.\+try\+\_\+export (\begin{DoxyParamCaption}\item[{}]{inner\+\_\+func}{}\end{DoxyParamCaption})}

\begin{DoxyVerb}Log success or failure, execution time, and file size for YOLOv5 model export functions wrapped with @try_export.

Args:
    inner_func (Callable): The model export function to be wrapped by the decorator.

Returns:
    Callable: The wrapped function that logs execution details. When executed, this wrapper function returns either:
        - Tuple (str | torch.nn.Module): On success — the file path of the exported model and the model instance.
        - Tuple (None, None): On failure — None values indicating export failure.

Examples:
    ```python
    @try_export
    def export_onnx(model, filepath):
        # implementation here
        pass

    exported_file, exported_model = export_onnx(yolo_model, 'path/to/save/model.onnx')
    ```

Notes:
    For additional requirements and model export formats, refer to the
    [Ultralytics YOLOv5 GitHub repository](https://github.com/ultralytics/ultralytics).
\end{DoxyVerb}
 

\doxysubsection{Variable Documentation}
\Hypertarget{namespaceexport_a9bfae37ca15b3f687b2907c4b6fa38c5}\index{export@{export}!FILE@{FILE}}
\index{FILE@{FILE}!export@{export}}
\doxysubsubsection{\texorpdfstring{FILE}{FILE}}
{\footnotesize\ttfamily \label{namespaceexport_a9bfae37ca15b3f687b2907c4b6fa38c5} 
export.\+FILE = Path(\+\_\+\+\_\+file\+\_\+\+\_\+).resolve()}

\Hypertarget{namespaceexport_a29e5fa5781007b2f0a95df7c46cd4979}\index{export@{export}!MACOS@{MACOS}}
\index{MACOS@{MACOS}!export@{export}}
\doxysubsubsection{\texorpdfstring{MACOS}{MACOS}}
{\footnotesize\ttfamily \label{namespaceexport_a29e5fa5781007b2f0a95df7c46cd4979} 
str export.\+MACOS = "{}Darwin"{}}

\Hypertarget{namespaceexport_a0d9efe06403dd5221657e8ff6c0230ca}\index{export@{export}!opt@{opt}}
\index{opt@{opt}!export@{export}}
\doxysubsubsection{\texorpdfstring{opt}{opt}}
{\footnotesize\ttfamily \label{namespaceexport_a0d9efe06403dd5221657e8ff6c0230ca} 
export.\+opt = \mbox{\hyperlink{namespaceexport_a7b4d8d1164f643274a56d56ad458f35b}{parse\+\_\+opt}}()}

\Hypertarget{namespaceexport_aa2a435b13a4c49dde8c5c3f389bdd2d5}\index{export@{export}!ROOT@{ROOT}}
\index{ROOT@{ROOT}!export@{export}}
\doxysubsubsection{\texorpdfstring{ROOT}{ROOT}}
{\footnotesize\ttfamily \label{namespaceexport_aa2a435b13a4c49dde8c5c3f389bdd2d5} 
export.\+ROOT = FILE.\+parents\mbox{[}0\mbox{]}}

